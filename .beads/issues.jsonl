{"id":"bytefreq-1sd","title":"Update CLAUDE.md with Excel architecture","description":"Update CLAUDE.md to document:\n- Excel processing architecture using calamine\n- How Excel data flows through the system\n- Sheet selection mechanism\n- Data type conversion strategy (Excel types -\u003e strings)\n- Optional feature flag setup\n- Key functions in src/excel.rs module\n- Integration points with existing tabular pipeline\n\nAdd to 'Data Processing Pipeline' section and 'Common Development Patterns' section.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T19:20:12.613308Z","updated_at":"2025-12-12T20:41:14.739328Z","closed_at":"2025-12-12T20:41:14.739328Z","dependencies":[{"issue_id":"bytefreq-1sd","depends_on_id":"bytefreq-l05","type":"blocks","created_at":"2025-12-12T19:20:24.516465Z","created_by":"daemon"}]}
{"id":"bytefreq-37h","title":"Update README with native Excel support","description":"Update README.md to:\n- Add section on native Excel support (after 'Processing Microsoft Excel Files' section)\n- Document how to build with Excel feature: cargo build --release --features excel\n- Provide usage examples for .xlsx, .xls, .xlsb, .ods files\n- Show sheet selection examples (--sheet, --sheet-name)\n- Update feature list to mention native Excel support\n- Note that Excel feature is optional (requires feature flag)\n\nKeep existing Excel conversion section for users without the feature enabled.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T19:20:12.427465Z","updated_at":"2025-12-12T20:41:14.738499Z","closed_at":"2025-12-12T20:41:14.738499Z","dependencies":[{"issue_id":"bytefreq-37h","depends_on_id":"bytefreq-l05","type":"blocks","created_at":"2025-12-12T19:20:24.489399Z","created_by":"daemon"}]}
{"id":"bytefreq-4tb","title":"Add native Excel file support using calamine","description":"Implement native Excel (.xlsx, .xls, .xlsb, .ods) file reading support using the calamine crate. This eliminates the need for external conversion tools.\n\nDependencies already added:\n- calamine = { version = \"0.26\", optional = true }\n- Feature flag 'excel' created\n\nRemaining work tracked in subtasks.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-12T19:19:43.882543Z","updated_at":"2025-12-12T21:42:52.551841Z","closed_at":"2025-12-12T21:42:52.551841Z","dependencies":[{"issue_id":"bytefreq-4tb","depends_on_id":"bytefreq-55j","type":"blocks","created_at":"2025-12-12T19:20:24.822744Z","created_by":"daemon"},{"issue_id":"bytefreq-4tb","depends_on_id":"bytefreq-dq0","type":"blocks","created_at":"2025-12-12T19:20:24.851021Z","created_by":"daemon"},{"issue_id":"bytefreq-4tb","depends_on_id":"bytefreq-l05","type":"blocks","created_at":"2025-12-12T19:20:24.877624Z","created_by":"daemon"},{"issue_id":"bytefreq-4tb","depends_on_id":"bytefreq-37h","type":"blocks","created_at":"2025-12-12T19:20:24.904133Z","created_by":"daemon"},{"issue_id":"bytefreq-4tb","depends_on_id":"bytefreq-1sd","type":"blocks","created_at":"2025-12-12T19:20:24.931923Z","created_by":"daemon"},{"issue_id":"bytefreq-4tb","depends_on_id":"bytefreq-p9s","type":"blocks","created_at":"2025-12-12T19:20:24.957501Z","created_by":"daemon"}]}
{"id":"bytefreq-55j","title":"Create Excel reader module (src/excel.rs)","description":"Create src/excel.rs module that:\n- Opens Excel workbooks using calamine\n- Iterates over sheets and rows\n- Converts Excel data to tabular format compatible with existing pipeline\n- Handles multiple data types (strings, numbers, dates, bools, errors)\n- Returns iterator or Vec\u003cVec\u003cString\u003e\u003e for processing\n\nKey considerations:\n- First row should be header (consistent with tabular format)\n- Handle empty cells appropriately\n- Convert all cell types to strings for masking\n- Support lazy loading for large files where possible","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T19:20:11.852258Z","updated_at":"2025-12-12T19:38:56.006015Z","closed_at":"2025-12-12T19:38:56.006015Z"}
{"id":"bytefreq-dq0","title":"Add 'excel' format option to CLI","description":"Update main.rs CLI argument parsing:\n- Add 'excel' as a valid value for --format/-f flag\n- Update help text to document Excel support\n- Add --sheet/-s option to specify which sheet to process (default: first sheet)\n- Add --sheet-name option to process sheet by name instead of index\n- Ensure format validation includes 'excel'\n\nCLI should support:\nbytefreq -f excel \u003c file.xlsx\nbytefreq -f excel --sheet 2 \u003c file.xlsx  \nbytefreq -f excel --sheet-name \"Sales\" \u003c file.xlsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T19:20:12.04681Z","updated_at":"2025-12-12T19:41:15.333446Z","closed_at":"2025-12-12T19:41:15.333446Z","dependencies":[{"issue_id":"bytefreq-dq0","depends_on_id":"bytefreq-55j","type":"blocks","created_at":"2025-12-12T19:20:24.161905Z","created_by":"daemon"}]}
{"id":"bytefreq-l05","title":"Integrate Excel processing into main event loop","description":"Modify main.rs to:\n- Detect 'excel' format and route to Excel processing path\n- Read Excel file from stdin or file path\n- Feed Excel rows into existing tabular processing pipeline\n- Reuse existing frequency_maps, example_maps, column_names logic\n- Support enhanced output modes (-e, -E) for Excel data\n- Handle errors gracefully (invalid Excel files, missing sheets, etc.)\n\nIntegration points:\n- Use existing Arc\u003cMutex\u003c\u003e\u003e shared state\n- Leverage Rayon for parallel row processing if beneficial\n- Maintain compatibility with existing DQ and CP report modes","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-12T19:20:12.237993Z","updated_at":"2025-12-12T19:41:15.484118Z","dependencies":[{"issue_id":"bytefreq-l05","depends_on_id":"bytefreq-55j","type":"blocks","created_at":"2025-12-12T19:20:24.300427Z","created_by":"daemon"},{"issue_id":"bytefreq-l05","depends_on_id":"bytefreq-dq0","type":"blocks","created_at":"2025-12-12T19:20:24.330576Z","created_by":"daemon"}]}
{"id":"bytefreq-p9s","title":"Add tests for Excel functionality","description":"Create tests for Excel processing:\n- Unit tests for src/excel.rs module\n- Test reading different Excel formats (.xlsx, .xls)\n- Test sheet selection (by index and name)\n- Test data type conversion\n- Test error handling (invalid files, missing sheets)\n- Integration test with sample Excel file in testdata/\n- Test enhanced output modes with Excel input\n\nAdd sample Excel test files to testdata/ directory.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T19:20:12.806848Z","updated_at":"2025-12-12T21:42:52.550705Z","closed_at":"2025-12-12T21:42:52.550705Z","dependencies":[{"issue_id":"bytefreq-p9s","depends_on_id":"bytefreq-l05","type":"blocks","created_at":"2025-12-12T19:20:24.666674Z","created_by":"daemon"}]}
{"id":"bytefreq-yif","title":"Replace naive delimiter splitting with csv crate parser","description":"Replace string.split(delimiter) with proper CSV parsing using the csv crate (already in Cargo.toml).\n\nCurrent problem:\n- Naive .split(delimiter) doesn't handle quoted fields with embedded commas\n- Causes ragged data issues on Excel-exported CSV files\n- Fields like \"Smith, John\" are incorrectly split into two fields\n\nSolution:\n- Use csv::ReaderBuilder with configurable delimiter\n- Handle quoted fields, escaped quotes, and proper field boundaries\n- Apply to both header parsing and data row parsing\n- Maintain compatibility with existing delimiter parameter","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T22:06:49.476059Z","updated_at":"2025-12-12T22:10:08.841075Z","closed_at":"2025-12-12T22:10:08.841075Z"}
